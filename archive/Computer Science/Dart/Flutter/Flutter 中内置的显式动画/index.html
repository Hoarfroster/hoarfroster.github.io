<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flutter 中内置的显式动画</title>
    <script src="/assets/script/main.js"></script>
    <link rel="stylesheet" href="/assets/style/styles.css">
</head>

<body>
    <div class="header">
    <div class="container">
        <div class="icon">
            <img src="/assets/media/vectors/hoarfroster-text.svg" alt="Hoarfroster Logo with Text">
        </div>
        <nav class="navigation">
            <ul class="header-navigation-list">
                <li><a href="/">首页</a></li>
                <li><a href="/archive.html">文章</a></li>
                <li><a href="/about.html">关于</a></li>
            </ul>
            <form action="/search" method="post">
                <label>
                    <input type="text" class="search" placeholder="搜索咕咕咕的小站"/>
                </label>
                <label class="submit">
                    <input type="submit"/>
                </label>
            </form>
        </nav>
        <ul class="social-accounts">
            <li>
                <a href="https://www.zhihu.com/people/shuang-yu-29-75">
                    <i class="fa-brands fa-zhihu" style="font-size: 20px; color:#06f; line-height: 20px;"></i>
                </a>
            </li>
            <li>
                <a href="https://github.com/PassionPenguin">
                    <img src="/assets/media/vectors/github.svg" alt="github-logo"/>
                </a>
            </li>
            <li>
                <a href="https://dribbble.com/Hoarfroster">
                    <img src="/assets/media/vectors/dribbble.svg" alt="dribbble-logo"/>
                </a>
            </li>
        </ul>
    </div>
</div>
    <div class="content article">
        <article>
            <div class="title">
                <h1>Flutter 中内置的显式动画</h1>
                <p><span class='chars'>7596B</span><span class='created-date'>Created Sun Jun 12 2022 23:55:03 GM</span><span class='modified-date'>Modified Sun Jun 12 2022 23:55:03 GM</span></p>
            </div>
            <div class="main markdown-body">
                

<blockquote>
<ul>
<li>原文地址：<a href="https://medium.com/flutterdevs/built-in-explicit-animations-in-flutter-438a039dd90">Built-in
Explicit Animations in Flutter</a></li>
<li>原文作者：<a href="https://medium.com/@shaiq_khan">Shaiq
khan</a></li>
<li>译者：<a href="https://github.com/PassionPenguin">霜羽
Hoarfroster</a></li>
<li>校对者：<a href="https://github.com/lsvih">lsvih</a></li>
</ul>
</blockquote>
<p><img src="https://cdn-images-1.medium.com/max/2160/1*-VpftDFf_ArJZoyuOjqBJA.png"></p>
<p>在我们的 <a href="https://medium.com/flutterdevs/staggered-animation-in-flutter-e7282a936b99">上一篇文章</a>
中，我们弄清楚了如何利用 Flutter
的交织动画编写一些完美的动画。<code>AnimatedFoo</code> 和
<code>TweenAnimationBuilder</code>
让我们能够将一些基本动画运用在应用程序中。这些动画通常从头到尾使用补间进行渲染，而在这背后，Flutter
代替了我们控制好了这一切，满足了我们对动画的预期，也让我们不用再担心动画的播放顺序。</p>
<p>对于部分动画来说，使用补间动画是极好的选择。当然，我们也可以用另外一种方式重新开始制作新的动画。</p>
<p>Flutter 有很多带有过渡动画的控件，而它们都以 <code>Transition</code>
结尾，它们包括了 <a href="https://api.flutter.cn/flutter/widgets/ScaleTransition-class.html"><code>ScaleTransition</code></a>、<a href="https://api.flutter.cn/flutter/widgets/SizeTransition-class.html"><code>SizeTransition</code></a>、<a href="https://api.flutter.cn/flutter/widgets/DecoratedBoxTransition-class.html"><code>DecoratedBoxTransition</code></a>。它们与我们所创作的的
<code>AnimateBlah</code> 控件非常类似。</p>
<p>例如说 <a href="https://api.flutter.cn/flutter/widgets/PositionedTransition-class.html"><code>PositionedTransition</code></a>，它可以产生在各个位置移动的小部件的动画。这些动画与补间动画很是相像，但是有明显的不同：这些
<code>Transition</code> 控件应该在 <a href="https://api.flutter.cn/flutter/widgets/AnimatedWidget-class.htmlhttps://api.flutter.dev/flutter/widgets/AnimatedWidget-class.html"><code>AnimatedWidget</code></a>
的构造中使用，而这就是显式动画。</p>
<p><img src="https://cdn-images-1.medium.com/max/5760/1*Rj0MJbE-gRj3gmUTwSkKog.jpeg" alt="一张太阳的图片，没有旋转"></p>
<h2 id="rotationtransition-旋转变换"><code>RotationTransition</code>
旋转变换</h2>
<p><a href="https://api.flutter.cn/flutter/widgets/RotationTransition-class.html"><code>RotationTransition</code></a>
是一个非常有用的控件，它的构造语句仅仅需要三个属性。</p>
<pre class="dart"><code>// （大多数的） RotationTransition 构造语句
RotationTransition({
  Widget child,
  Alignment alignment,
  Animation&lt;double&gt; turns
})</code></pre>
<p><code>child</code> — 提供要旋转的控件，这里是显示太阳的图片的控件
<code>GalaxyWay()</code>。接下来我们要在 <code>alignment</code>
中提供控件旋转的中心（对齐），此处我们规定了图片的中心，即太阳的中心 ——
我们的预期嘛。</p>
<pre class="dart"><code>RotationTransition(
  child: GalaxyWay(),
  alignment: Alignment.center,
  turns: _repeatingAnimationLong
),</code></pre>
<p>简简单单的代码就是使 <code>RotationTransition</code> 和各种
<code>Transition</code>
控件构成的动画被称为显式动画的原因。我们只需通过调用
<code>AnimatedContainer</code>
控件并进行更改就可以轻松实现旋转动画。借助显式动画，我们可以控制时间与旋转次数，使太阳不断旋转。</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*oeGSTGSJwkqzQueCykTggw.gif"></p>
<p>对于 <code>RotationTransition</code> 而言，属性 <code>turns</code>
会直接影响我们的控件的旋转次数，而它所接受的输入类型是
<code>Animation&lt;double&gt;</code>。</p>
<h2 id="创建一个-animationcontroller-动画控制器">创建一个
<code>AnimationController</code> 动画控制器</h2>
<p>得到一个 <code>Animation&lt;double&gt;</code>
值最有效的方法是创建一个 <a href="https://api.flutter.cn/flutter/animation/AnimationController-class.html"><code>AnimationController</code>
动画控制器</a>。这个控制器将会为我们控制每一帧的动画。</p>
<p>我们必须在有状态的控件 <code>StatefulWidget</code>
中进行设置，以保证我们能够持续访问并操作动画控制器。由于
<code>AnimationController</code>
同样具有自己的状态要管理，因此我们需要在 <code>initState()</code>
中对其进行初始化，并在 <code>dispose()</code> 中对其进行处理。</p>
<p>我们应为“动画控制器”提供两个参数，第一个是动画的持续长度。Dart
为我们提供了一个 <code>Duration</code>
类供使用。对于这个例子，让我们设定下来，让太阳的图片转动一次持续 5
秒，然后暂停旋转 15 秒，咋样？</p>
<pre class="dart"><code>_animationController = AnimationController(
  duration: Duration(seconds: 15),
  // TODO: 尚需完成剩余构造
);</code></pre>
<p>在我们把控制器制作完成以后，我们不会再需要编写完成太多的代码。这是因为我们已获得一个控制器。</p>
<p>创建 <code>AnimationController</code> 的同时，我们也要赋予一个
<code>vsync</code> 参数。<code>vsync</code>
的存在防止后台动画消耗不必要的资源。我们可以通过添加
<code>SingleTickerProviderStateMixin</code>
到控件的类定义，将有状态的控件赋予给 <code>vsync</code>。</p>
<p>另外，我们需要太阳永远旋转下去，不是吗？为此，我们需要要求控制器重复动画下去。</p>
<pre class="dart"><code>_animationController = AnimationController(
  duration: Duration(seconds: 15),
  vsync: this,
)..repeat();</code></pre>
<h2 id="使用-animationcontroller-动画控制器">使用
<code>AnimationController</code> 动画控制器</h2>
<p>仁慈的我还添加了一个彩蛋，让用户可以控制阳光。我在页面中添加一个基本按钮，并隐藏在了动画中，然后我将其传递给控制器的引用，以便在其
<code>onTap</code> 监听中可以停止或重新开始动画。</p>
<p>控制器将维护包括动画的状态在内的各种状态。如果动画正在播放，我们可以检查动画状态，也可以停止播放动画。而如果动画不在播放中，我们可以使用控制器重新启动动画。也就是说，通过使用动画控制器，我们就可以根据需求控制动画的播放与暂停。除此之外，动画控制器还有一些其它的功能。</p>
<p>通过使用控制器，我们可以同样地为特定值设置动画（或从该值反向），并以给定的速度播放动画，或使用类似的控制器来控制各种动画。</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*qmRBKLFSVNTvW8-uWFvbKw.gif"></p>
<p>这只是我们对 Flutter 中的显式动画的第一次尝试。我们看到了 Transition
控件如何运行，以及学会了使用 <code>AnimationController</code>
来命令动画修改方向或其他动画属性。在以后的文章中，我们将进一步剖析显式动画以及介绍如何自定义使用显式动画。</p>
<p>在下面的视频中，我们可以看到这个显式动画的运行结果 ——
当我们在屏幕上的任意位置点击时，动画会被暂停。而在屏幕任意位置再次点击就会恢复动画的播放。同样的，我们也可以通过修改代码来控制动画的速度以及播放的方向。</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*y7sP1wxW1UHb_42Wv2foUw.gif"></p>
<p>这就是显式动画的基本入门了，我们在本文中构建了一个示例，而我相信，通过学习，你也同样可以轻松学会如何去制作这样一个动画，感谢你的阅读～</p>



            </div>
        </article>
        <div class="sidebar">
            <div class="about-box">
    <div class="avatar">
        <img src="/assets/media/bitmap/avatar.jpeg" alt="avatar">
    </div>
    <h1>霜羽 Hoarfroster</h1>
    <h2>@PassionPenguin</h2>
    <p class="moment"><span class="status">🤔</span><span>努力！</span></p>
    <ul>
        <li><i class="fa-solid fa-location-dot"></i> 广东 · 广州 | <span class="light">Guangzhou, China</span>
        </li>
        <li><i class="fa-solid fa-envelope"></i> <a href="mailto:hoarfroster@outlook.com">hoarfroster@outlook.com</a>
        </li>
        <li><i class="fa-solid fa-house"></i> <a href="https://story.hoarfroster.space/">https://story.hoarfroster.space/</a>
        </li>
    </ul>
</div>
<div class="organization">
    <h4>组织 Organizations</h4>
    <ul>
        <li>
            <img src="https://avatars.githubusercontent.com/u/81648011?s=60&amp;v=4"
                alt="Hexa-Penguin"><span>Hexa-Penguin</span>
        </li>
        <li>
            <img src="https://avatars.githubusercontent.com/u/10482599?s=60&amp;v=4" alt="xitu"><span>稀土 xitu</span>
        </li>
    </ul>
</div>
<div class="category">
    <span class="title">文章分类</span>
    <ul>
        <!-- <li><a href="/archive.html">所有分类</a></li> -->
    </ul>
</div>
<div class="archive">
    <span class="title">文章存档</span>
    <ul>
        <!-- <li><a href="/archive.html">所有文章</a></li> -->
    </ul>
</div>
        </div>
    </div>
    <div class="footer">
    <div class="content">
        <div class="about">
            <p>霜羽 Hoarfroster</p>
            <p>&copy; Copyright 2021 Hoarfroster and contributors.</p>
        </div>
        <div class="nav">
            <div class="links">
                <span class="title">关于文章</span>
                <ul>
                    <li><a href="/archive.html">文章存档</a></li>
                </ul>
            </div>
            <div class="category">
                <span class="title">关于霜羽</span>
                <ul>
                    <li><a href="/about.html">有关霜羽</a></li>
                </ul>
            </div>
        </div>
    </div>
    <ul class="social-accounts">
        <li>
            <a href="https://www.zhihu.com/people/shuang-yu-29-75">
                <i class="fa-brands fa-zhihu" style="font-size: 24px; color:#06f; line-height: 24px;"></i>
            </a>
        </li>
        <li>
            <a href="https://github.com/PassionPenguin">
                <img src="/assets/media/vectors/github.svg" alt="github-logo"/>
            </a>
        </li>
        <li>
            <a href="https://dribbble.com/Hoarfroster">
                <img src="/assets/media/vectors/dribbble.svg" alt="dribbble-logo"/>
            </a>
        </li>
        <li>
            <a href="https://zh.wikipedia.org/wiki/User:HoarfrostFeather">
                <i class="fa-brands fa-wikipedia-w" style="font-size: 22px; color: #888; line-height: 24px;"></i>
            </a>
        </li>
        <li>
            <a href="https://space.bilibili.com/201469972">
                <i class="fa-brands fa-bilibili" style="font-size: 22px; color: #00a1d6; line-height: 24px;"></i>
            </a>
        </li>
    </ul>
</div>
</body>

</html>