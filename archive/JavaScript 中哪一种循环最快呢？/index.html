<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript 中哪一种循环最快呢？</title>
    <script src="/assets/script/main.js"></script>
    <link rel="stylesheet" href="/assets/style/styles.css">
</head>

<body>
    <div class="header">
    <div class="container">
        <div class="icon">
            <img src="/assets/media/vectors/hoarfroster-text.svg" alt="Hoarfroster Logo with Text">
        </div>
        <nav class="navigation">
            <ul class="header-navigation-list">
                <li><a href="/">首页</a></li>
                <li><a href="/archive.html">文章</a></li>
                <li><a href="/about.html">关于</a></li>
            </ul>
            <form action="/search" method="post">
                <label>
                    <input type="text" class="search" placeholder="搜索咕咕咕的小站"/>
                </label>
                <label class="submit">
                    <input type="submit"/>
                </label>
            </form>
        </nav>
        <ul class="social-accounts">
            <li>
                <a href="https://www.zhihu.com/people/shuang-yu-29-75">
                    <i class="fa-brands fa-zhihu" style="font-size: 20px; color:#06f; line-height: 20px;"></i>
                </a>
            </li>
            <li>
                <a href="https://github.com/PassionPenguin">
                    <img src="/assets/media/vectors/github.svg" alt="github-logo"/>
                </a>
            </li>
            <li>
                <a href="https://dribbble.com/Hoarfroster">
                    <img src="/assets/media/vectors/dribbble.svg" alt="dribbble-logo"/>
                </a>
            </li>
        </ul>
    </div>
</div>
    <div class="content article">
        <article>
            <div class="title">
                <h1>JavaScript 中哪一种循环最快呢？</h1>
                <p><span class='chars'>undefined chars</span><span class='created-date'>Created Sat May 28 2022 23:43:08 GM</span><span class='modified-date'>Modified Sat May 28 2022 23:43:08 GM</span></p>
            </div>
            <div class="main markdown-body">
                

<blockquote>
<ul>
<li>原文地址：<a href="https://medium.com/javascript-in-plain-english/which-type-of-loop-is-fastest-in-javascript-ec834a0f21b9">Which
type of loop is fastest in JavaScript?</a></li>
<li>原文作者：<a href="https://kushsavani.medium.com/">kushsavani</a></li>
<li>译者：<a href="https://github.com/PassionPenguin">霜羽
Hoarfroster</a></li>
<li>校对者：<a href="https://github.com/Chorer">Chorer</a>、<a href="https://github.com/HumanBeingXenon">HumanBeing</a>、<a href="https://juejin.cn/user/2840793777440296">yoghurt</a></li>
</ul>
</blockquote>
<p>了解哪一种 <code>for</code>
循环或迭代器适合我们的需求，防止我们犯下一些影响应用性能的低级错误。</p>
<p><img src="https://miro.medium.com/max/10944/0*FjGuCxH-seN1PrRF" alt="由 Artem Sapegin 上传至 Unsplash"></p>
<p>JavaScript 是 Web 开发领域的“常青树”。无论是 JavaScript 框架（如
Node.js、React、Angular、Vue 等），还是原生
JavaScript，都拥有非常庞大的粉丝基础。我们来谈谈现代 JavaScript
吧。循环一直是大多数编程语言的重要组成部分，而现代 JavaScript
为我们提供了许多迭代或循环值的方法。</p>
<p>但问题在于，我们是否真的知道哪种循环或迭代最适合我们的需求。<code>for</code>
循环有很多变形，例如
<code>for</code>、<code>for</code>（倒序）、<code>for…of</code>、<code>forEach</code>、<code>for…in</code>、<code>for…await</code>。本文将围绕这些展开讨论。</p>
<h2 id="究竟哪一种循环更快"><strong>究竟哪一种循环更快？</strong></h2>
<p><strong>答案其实是：</strong> <code>for</code>（倒序）</p>
<p>最让我感到惊讶的事情是，当我在本地计算机上进行测试之后，我不得不接受
<code>for</code>（倒序）是所有 <code>for</code>
循环中最快的这一事实。下面我会举个对一个包含超过一百万项元素的数组执行一次循环遍历的例子。</p>
<p><strong>声明</strong>：<code>console.time()</code>
结果的准确度在很大程度上取决于我们运行测试的系统配置。你可以在<a href="https://johnresig.com/blog/accuracy-of-javascript-time/">此处</a>对准确度作进一步了解。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode JavaScript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> million <span class="op">=</span> <span class="dv">1000000</span><span class="op">;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> arr <span class="op">=</span> <span class="bu">Array</span>(million)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">time</span>(<span class="st">'⏳'</span>)<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> arr<span class="op">.</span><span class="at">length</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--</span>) {} <span class="co">// for(倒序)  :- 1.5ms</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> arr<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {} <span class="co">// for          :- 1.6ms</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>arr<span class="op">.</span><span class="fu">forEach</span>(v <span class="kw">=&gt;</span> v)                     <span class="co">// foreach      :- 2.1ms</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">const</span> v <span class="kw">of</span> arr) {}                 <span class="co">// for...of     :- 11.7ms</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">timeEnd</span>(<span class="st">'⏳'</span>)<span class="op">;</span></span></code></pre></div>
<p>造成这样结果的原因很简单，在代码中，正序和倒序的 <code>for</code>
循环几乎花费一样的时间，仅仅相差了 0.1
毫秒。原因是，<code>for</code>（倒序）只需要计算一次起始变量
<code>let i = arr.length</code>，而在正序的 <code>for</code>
循环中，它在每次变量增加后都会检查条件
<code>i&lt;arr.length</code>。这个细微的差别不是很重要，你可以忽略它。（译者注：在数据量小或对时间不敏感的代码上，我们大可忽略它，但是根据译者的测试，当数据量扩大，例如十亿，千亿等的数量级，差距就显著提升，我们就需要考虑时间对应用程序性能的影响了。）</p>
<p>而 <code>forEach</code> 是 <code>Array</code>
原型的一个方法，与普通的 <code>for</code> 循环相比，<code>forEach</code>
和 <code>for…of</code>
需要花费更多的时间进行数组迭代。（译者注：但值得注意的是，<code>for…of</code>
和 <code>forEach</code>
都从对象中获取了数据，而原型并没有，因此没有可比性。）</p>
<h2 id="循环的类型以及我们应该在何处使用它们"><strong>循环的类型，以及我们应该在何处使用它们</strong></h2>
<h3 id="1-for-循环正序和倒序"><strong>1. For
循环（正序和倒序）</strong></h3>
<p>我想，也许大家都应该对这个基础循环非常熟悉了。我们可以在任何我们需要的地方使用
<code>for</code> 循环，按照核定的次数运行一段代码。最基础的
<code>for</code>
循环运行最迅速的，那我们每一次都应该使用它，对吗？并不然，性能不仅仅只是唯一尺度，代码可读性往往更加重要，就让我们选择适合我们应用程序的变形即可。</p>
<h3 id="2-foreach"><strong>2. <code>forEach</code></strong></h3>
<p>这个方法需要接受一个回调函数作为输入参数，遍历数组的每一个元素，并执行我们的回调函数（以元素本身和它的索引（可选参数）作为参数赋予给回调函数）。<code>forEach</code>
还允许在回调函数中使用一个可选参数 <code>this</code>。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode JavaScript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> things <span class="op">=</span> [<span class="st">'have'</span><span class="op">,</span> <span class="st">'fun'</span><span class="op">,</span> <span class="st">'coding'</span>]<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> callbackFun <span class="op">=</span> (item<span class="op">,</span> idex) <span class="kw">=&gt;</span> {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`</span><span class="sc">${</span>item<span class="sc">}</span><span class="vs"> - </span><span class="sc">${</span>index<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>things<span class="op">.</span><span class="fu">foreach</span>(callbackFun)<span class="op">;</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* 输出   have - 0</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">        fun - 1</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">        coding - 2 */</span></span></code></pre></div>
<p>需要注意的是，如果我们要使用 <code>forEach</code>，我们不能使用
JavaScript
的短路运算符（||、&amp;&amp;……），即不能在每一次循环中跳过或结束循环。</p>
<h3 id="3-forof"><strong>3. <code>for…of</code></strong></h3>
<p><code>for…of</code> 是在 ES6（ECMAScript
6）中实现标准化的。它会对一个可迭代的对象（例如
<code>array</code>、<code>map</code>、<code>set</code>、<code>string</code>
等）创建一个循环，并且有一个突出的优点，即优秀的可读性。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode JavaScript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> arr <span class="op">=</span> [<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span>]<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> str <span class="op">=</span> <span class="st">'hello'</span><span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="kw">of</span> arr) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>   <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(i)<span class="op">;</span> <span class="co">// 输出 3, 5, 7</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="kw">of</span> str) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>   <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(i)<span class="op">;</span> <span class="co">// 输出 'h', 'e', 'l', 'l', 'o'</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>需要注意的是，请不要在生成器中使用 <code>for……of</code>，即便
<code>for……of</code>
循环提前终止。在退出循环后，生成器被关闭，并尝试再次迭代，不会产生任何进一步的结果。</p>
<h3 id="4-for-in"><strong>4. <code>for</code>
<code>in</code></strong></h3>
<p><code>for…in</code>
会在对象的所有可枚举属性上迭代指定的变量。对于每个不同的属性，<code>for…in</code>
语句除返回数字索引外，还将返回用户定义的属性的名称。
因此，在遍历数组时最好使用带有数字索引的传统 <code>for</code> 循环。
因为 <code>for…in</code>
语句还会迭代除数组元素之外的用户定义属性，就算我们修改了数组对象（例如添加自定义属性或方法），依然如此。</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode JavaScript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> details <span class="op">=</span> {<span class="dt">firstName</span><span class="op">:</span> <span class="st">'john'</span><span class="op">,</span> <span class="dt">lastName</span><span class="op">:</span> <span class="st">'Doe'</span>}<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> fullName <span class="op">=</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="kw">in</span> details) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    fullName <span class="op">+=</span> details[i] <span class="op">+</span> <span class="st">' '</span><span class="op">;</span> <span class="co">// fullName: john doe</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="forof-和-forin"><code>for…of</code> 和 <code>for…in</code></h3>
<p><code>for…of</code> 和 <code>for…in</code>
之间的主要区别是它们迭代的内容。<code>for…in</code>
循环遍历对象的属性，而 <code>for…of</code> 循环遍历可迭代对象的值。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode JavaScript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> arr<span class="op">=</span> [<span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span>]<span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="kw">in</span> arr) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(i)<span class="op">;</span> <span class="co">// '0', '1', '2'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">let</span> i <span class="kw">of</span> arr) {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(i)<span class="op">;</span> <span class="co">// '4', '5', '6'</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="https://miro.medium.com/max/12000/0*E9FPH2LFeFnTGWF5" alt="由 Tine Ivanič 上传至 Unsplash"></p>
<h3 id="结论"><strong>结论</strong></h3>
<ul>
<li><code>for</code> 最快，但可读性比较差</li>
<li><code>foreach</code> 比较快，能够控制内容</li>
<li><code>for...of</code> 比较慢，但香</li>
<li><code>for...in</code> 比较慢，没那么方便</li>
</ul>
<p>最后，给你一条明智的建议 ——
优先考虑可读性。尤其是当我们开发复杂的结构程序时，更需要这样做。当然，我们也应该专注于性能。尽量避免增添不必要的、多余的花哨代码，因为这有时可能对你的程序性能造成严重影响。祝你编码愉快。</p>



            </div>
        </article>
        <div class="sidebar">
            <div class="about-box">
    <div class="avatar">
        <img src="/assets/media/bitmap/avatar.jpeg" alt="avatar">
    </div>
    <h1>霜羽 Hoarfroster</h1>
    <h2>@PassionPenguin</h2>
    <p class="moment"><span class="status">🤔</span><span>努力！</span></p>
    <ul>
        <li><i class="fa-solid fa-location-dot"></i> 广东 · 广州 | <span class="light">Guangzhou, China</span>
        </li>
        <li><i class="fa-solid fa-envelope"></i> <a href="mailto:hoarfroster@outlook.com">hoarfroster@outlook.com</a>
        </li>
        <li><i class="fa-solid fa-house"></i> <a href="https://story.hoarfroster.space/">https://story.hoarfroster.space/</a>
        </li>
    </ul>
</div>
<div class="organization">
    <h4>组织 Organizations</h4>
    <ul>
        <li>
            <img src="https://avatars.githubusercontent.com/u/81648011?s=60&amp;v=4"
                alt="Hexa-Penguin"><span>Hexa-Penguin</span>
        </li>
        <li>
            <img src="https://avatars.githubusercontent.com/u/10482599?s=60&amp;v=4" alt="xitu"><span>稀土 xitu</span>
        </li>
    </ul>
</div>
<div class="category">
    <span class="title">文章分类</span>
    <ul>
        <!-- <li><a href="/archive.html">所有分类</a></li> -->
    </ul>
</div>
<div class="archive">
    <span class="title">文章存档</span>
    <ul>
        <!-- <li><a href="/archive.html">所有文章</a></li> -->
    </ul>
</div>
        </div>
    </div>
    <div class="footer">
    <div class="content">
        <div class="about">
            <p>霜羽 Hoarfroster</p>
            <p>&copy; Copyright 2021 Hoarfroster and contributors.</p>
        </div>
        <div class="nav">
            <div class="links">
                <span class="title">关于文章</span>
                <ul>
                    <li><a href="/archive.html">文章存档</a></li>
                </ul>
            </div>
            <div class="category">
                <span class="title">关于霜羽</span>
                <ul>
                    <li><a href="/about.html">有关霜羽</a></li>
                </ul>
            </div>
        </div>
    </div>
    <ul class="social-accounts">
        <li>
            <a href="https://www.zhihu.com/people/shuang-yu-29-75">
                <i class="fa-brands fa-zhihu" style="font-size: 24px; color:#06f; line-height: 24px;"></i>
            </a>
        </li>
        <li>
            <a href="https://github.com/PassionPenguin">
                <img src="/assets/media/vectors/github.svg" alt="github-logo"/>
            </a>
        </li>
        <li>
            <a href="https://dribbble.com/Hoarfroster">
                <img src="/assets/media/vectors/dribbble.svg" alt="dribbble-logo"/>
            </a>
        </li>
        <li>
            <a href="https://zh.wikipedia.org/wiki/User:HoarfrostFeather">
                <i class="fa-brands fa-wikipedia-w" style="font-size: 22px; color: #888; line-height: 24px;"></i>
            </a>
        </li>
        <li>
            <a href="https://space.bilibili.com/201469972">
                <i class="fa-brands fa-bilibili" style="font-size: 22px; color: #00a1d6; line-height: 24px;"></i>
            </a>
        </li>
    </ul>
</div>
</body>

</html>